# AD間でフォレスト関係を結んで、AWS ALBへホストルーティングして接続

![Elastic-Load-Balancing_light-bg@4x.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Elastic-Load-Balancing_light-bg4x.png)

# 目次

---

# はじめに

---

ADのルートドメインが別のものを2台用意しております。

この2台をフォレスト関係を結んでもう片方のドメインのみで名前解決できるようにします。

その上でIPSecVPNで繋がっているAWS環境にALBを作成し、その後DNSレコードにALBのDNSをCNAMEで登録した上で

ホストルーティングを行えるかどうか検証をします。

ALB用のVPCとEC2のVPCを用意しているので、VPC間はVPC Peeringを実施しています。

# フォレスト関係を結ぶための準備

---

ドメインとしてはdev.net(192.168.11.53)とactmotech.xyz(192.168.11.162)が存在しています。

dev.netのドメインに所属しているものはactmotech.xyzのドメインも名前解決できるようにするためにフォレスト関係を結びます。

dev.netの条件付きフォワーダーにactmotech.xyz(192.168.11.162)を追加します。

# フォレスト関係を結ぶ

---

ドメインと信頼関係をクリックして信頼関係を作ります。ドメインの部分で右クリックでプロパティを選択します。

新しい信頼をクリックします。

![スクリーンショット 2023-06-22 0.23.57.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.23.57.png)

次へをクリックします

![スクリーンショット 2023-06-22 0.24.16.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.24.16.png)

対抗先のドメイン(actmotech.xyz)を入力して、次へをクリックします。

![スクリーンショット 2023-06-22 0.25.01.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.25.01.png)

フォレストの信頼を選択して次へをクリックします。

![スクリーンショット 2023-06-22 0.26.26.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.26.26.png)

今回はdev.netのドメインに所属しているものはactmotech.xyzのドメインも名前解決できるようにするが目的なので、

一方向：入力方向を選択して次へをクリックします。

![スクリーンショット 2023-06-22 0.26.52.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.26.52.png)

今回はdev.netのドメインに所属しているものはactmotech.xyzのドメインも名前解決できるようにするが目的なので、

actmotech.xyzの信頼関係を結ぶためにこのドメインのみを選択して、次へをクリックします。

![スクリーンショット 2023-06-22 0.27.38.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.27.38.png)

任意のパスワードを入力して次へをクリックします。

![スクリーンショット 2023-06-22 0.28.06.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.28.06.png)

内容を確認して次へをクリックし、信頼関係が作成されましたを確認して次へをクリックします。

![スクリーンショット 2023-06-22 0.29.10.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.29.10.png)

確認しないを選択して次へをクリックします。

![スクリーンショット 2023-06-22 0.29.22.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.29.22.png)

完了をクリックします。

![スクリーンショット 2023-06-22 0.29.35.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.29.35.png)

このドメインを信頼するドメイン（入力方向の信頼）に追加したドメインがあることを確認します。

# ALBとTargetGroupを作成してALBにTargetGroupを紐付け

---

ALBとTargetGroupの作成方法は省略します。

またALBのフロントは443ポートで受けて、フロントからバック間通信も443ポートで実施します。

ALBに使う証明書はバック側のサーバで作成した自己証明書を利用しています。

（CNが違っても今回はHTTPS通信ができることを確認できればよいため）

バック側のサーバにはWEB02とWEB03がいます。

WEB03のサーバ自己証明書作成し、ACMへインポートします。（CNはweb03.ray.com）

![スクリーンショット 2023-06-22 0.32.35.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.32.35.png)

インポートしたACMを使ってTargetGroupをALBに登録します。内容は以下の通りです。

![Untitled.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Untitled.png)

![Untitled](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Untitled%201.png)

![Untitled.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Untitled%202.png)

尚、ルールとしてはweb02.actmotech.xyzとアクセスがある際には、web02サーバへ通信が発生し、

web03.actmotech.xyzとアクセスがある際には、web03サーバへ通信が発生するようにルールを記載しています。

![Untitled](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Untitled%203.png)

![Untitled.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/Untitled%204.png)

# actmotech.xyzドメインのDNSレコードに追記

---

レコードを書かないとALBのルールで書いたホストルーティングができないため、

actmotech.xyzドメインのDNSにエイリアス情報を追記します。

![スクリーンショット 2023-06-22 0.38.43.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.38.43.png)

![スクリーンショット 2023-06-22 0.39.07.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.39.07.png)

# WEBアクセステスト

この状態でactmotech.xyzドメイン参加しているPCから以下のようにアクセスします。

https://web02.actmotech.xyz

![スクリーンショット 2023-06-22 0.37.25.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.37.25.png)

https://web03.actmotech.xyz

![スクリーンショット 2023-06-22 0.40.20.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.40.20.png)

次にdev.netドメイン参加しているPCから以下のようにアクセスします。

尚、actmotech.xyzへフォレスト済みであるためactmotech.xyzに書かれているレコードでアクセスができる状態です。

https://web02.actmotech.xyz

![スクリーンショット 2023-06-22 0.43.11.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.43.11.png)

https://web03.actmotech.xyz

![スクリーンショット 2023-06-22 0.44.33.png](AD%E9%96%93%E3%81%A6%E3%82%99%E3%83%95%E3%82%A9%E3%83%AC%E3%82%B9%E3%83%88%E9%96%A2%E4%BF%82%E3%82%92%E7%B5%90%E3%82%93%E3%81%A6%E3%82%99%E3%80%81AWS%20ALB%E3%81%B8%E3%83%9B%E3%82%B9%E3%83%88%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%AF%E3%82%99%E3%81%97%E3%81%A6%E6%8E%A5%E7%B6%9A%2060c285b146d74d6e85a2087d3f5131e0/%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AA%25E3%2583%25BC%25E3%2583%25B3%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%2583%25E3%2583%2588_2023-06-22_0.44.33.png)

# 補足：アクセスがドメインごとに分かれて良い場合

フォレスト関係を結ばずに各ドメインのDNSレコードに追記をすることでアクセスが可能になります。

またACMの証明書はそれぞれのドメインで取得したものを片方をデフォルトのSSL証明書、もう片方を追加のSSL証明書とすることで、

マルチドメインに対応することができますので、本環境に限らずVirtualHostでWebを公開している場合でも同様に対応可能です。

※本環境ではホストルーティングを行なっているので、dev.netドメインでのアクセスもするのであればALBのルールに追加してください。

# 最後に

dev.netからactmotech.xyzのドメインにあるDNSレコードでアクセスすることができたのでフォレストも問題なく動作しています。

証明書エラー（NET::ERR_CERT_AUTHORITY_INVALID）がでるのは自己証明書であるためエラーとなっているので想定通りです。

ACMでリクエストしてactmotech.xyzを管理しているDNS管理サーバからでDNS検証で発行したactmotech.xyzの証明書を使えば上記エラーは解消されます。

ただし単純にHTTPS通信ができればいい（証明書の中身が正しいかどうかは問わない）、かつ内部的な通信のみということであれば、

SSL証明書はなんでもよいのではないかと思います。（エラー出したくなければちゃんと証明書発行しましょう！）

また今回はフォレスト関係を結んだやり方をしましたが、上位DNSなどが存在する場合は条件付きフォーワードで、

上位DNSに名前解決をさせるやり方もあるかと思います。