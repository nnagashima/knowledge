<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>RHEL9検証 ⑥Let&#x27;s EncryptによるSSL証明書適用</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e09285f5-08d1-4c1e-8990-4c62e5292238" class="page sans"><header><h1 class="page-title">RHEL9検証 ⑥Let&#x27;s EncryptによるSSL証明書適用</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesMultipleSelect"><path d="M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"></path></svg></span>タグ</th><td><span class="selected-value select-value-color-blue">RHEL</span></td></tr></tbody></table></header><div class="page-body"><figure id="ec72b0fc-8b91-4dc3-921f-f5d6c85333d8" class="image" style="text-align:left"><a href="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A6%20Cockpit%E5%B0%8E%E5%85%A5%201289da9f37308067a685deffd613c2bf/images.png"><img style="width:204px" src="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A6%20Cockpit%E5%B0%8E%E5%85%A5%201289da9f37308067a685deffd613c2bf/images.png"/></a></figure><p id="3189868c-6ef1-45c6-acf1-b31c32836e37" class="">目次</p><nav id="9e44311a-f67d-49b4-835f-0f42d88aab84" class="block-color-default table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#08ee2516-891e-4831-b6e4-c2ee692a69e6">1.前提</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b22ac37-382d-4aaf-8db5-c235e9acd548">2.EPELリポジトリを有効化してEPELリポジトリをインストール</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#715b8057-57c7-4ea7-95be-b46750168a16">3.Snapdのインストール</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#479061b0-b248-4782-9f69-2cabcee3e9a1">4.Snapの起動とCertbotのインストール</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#95dd33d7-32f6-4036-918d-532387e5788b">5.Let’s EncryptからSSL証明書の取得とssl.confへ反映</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#d0f90b14-9af5-4b5c-97d7-dfcf0c6058c9">6.Webサイト評価をA+にするための修正</a></div></nav><h1 id="08ee2516-891e-4831-b6e4-c2ee692a69e6" class="">1.前提</h1><hr id="1289da9f-3730-8056-bc71-e526b53b9ca5"/><p id="319c2ef5-72a6-4b1c-a9b8-0f7938e9c25e" class="">80ポートと443ポートがインターネット環境からアクセスできることが望ましいですが、</p><p id="c004dcd2-4172-4814-95c9-d1b4bc27cc87" class="">ポート番号を変更して公開している方もいるかと思うので、標準のやり方ではなくDNS TXT recordを自分で登録して、</p><p id="14c29edd-cb8b-4cfe-8481-ac54056ff66b" class="">SSL証明書を発行するやり方を実施します。</p><p id="13d941e8-dff2-434b-864e-3f8ca675fc50" class="">なお、事前にサーバのGlobalIPとDNSが紐づけておいてください。（Aレコードが登録されている）</p><h1 id="2b22ac37-382d-4aaf-8db5-c235e9acd548" class="">2.EPELリポジトリを有効化してEPELリポジトリをインストール</h1><hr id="1289da9f-3730-80b6-868f-c4a715780488"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3d342ab7-97cd-42b7-9a38-07fe7f568a3c" class="code"><code class="language-Bash"># subscription-manager repos --enable codeready-builder-for-rhel-9-$(arch)-rpms
リポジトリー &#x27;codeready-builder-for-rhel-9-x86_64-rpms&#x27; は、このシステムに対して有効になりました。

# dnf install \
https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm
サブスクリプション管理リポジトリーを更新しています。
Red Hat CodeReady Linux Builder for RHEL 9 x86_64 (RPMs)                                                                                      5.5 MB/s | 4.8 MB     00:00    
epel-release-latest-9.noarch.rpm                                                                                                               14 kB/s |  18 kB     00:01    
依存関係が解決しました。
==============================================================================================================================================================================
 パッケージ                                  アーキテクチャー                      バージョン                               リポジトリー                                サイズ
==============================================================================================================================================================================
インストール:
 epel-release                                noarch                                9-5.el9                                  @commandline                                 18 k

トランザクションの概要
==============================================================================================================================================================================
インストール  1 パッケージ

合計サイズ: 18 k
インストール後のサイズ: 25 k
これでよろしいですか? [y/N]: y
パッケージのダウンロード:
トランザクションの確認を実行中
トランザクションの確認に成功しました。
トランザクションのテストを実行中
トランザクションのテストに成功しました。
トランザクションを実行中
  準備             :                                                                                                                                                      1/1 
  インストール中   : epel-release-9-5.el9.noarch                                                                                                                          1/1 
  scriptletの実行中: epel-release-9-5.el9.noarch                                                                                                                          1/1 
Many EPEL packages require the CodeReady Builder (CRB) repository.
It is recommended that you run /usr/bin/crb enable to enable the CRB repository.

  検証             : epel-release-9-5.el9.noarch                                                                                                                          1/1 
インストール済みの製品が更新されています。

インストール済み:
  epel-release-9-5.el9.noarch                                                                                                                                                 

完了しました</code></pre><h1 id="715b8057-57c7-4ea7-95be-b46750168a16" class="">3.Snapdのインストール</h1><hr id="1289da9f-3730-806a-97c6-fff621201466"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="068b9c0f-e59c-4338-82cb-eb45136625f3" class="code"><code class="language-Bash"># dnf install snapd
サブスクリプション管理リポジトリーを更新しています。
メタデータの期限切れの最終確認: 0:00:06 時間前の 2023年04月26日 20時27分43秒 に実施しました。
依存関係が解決しました。
==============================================================================================================================================================================
 パッケージ                                    アーキテクチャー             バージョン                              リポジトリー                                        サイズ
==============================================================================================================================================================================
インストール:
 snapd                                         x86_64                       2.58.3-1.el9                            epel                                                 15 M
アップグレード:
 selinux-policy                                noarch                       34.1.43-1.el9_1.2                       rhel-9-for-x86_64-baseos-rpms                        55 k
 selinux-policy-targeted                       noarch                       34.1.43-1.el9_1.2                       rhel-9-for-x86_64-baseos-rpms                       6.7 M
依存関係のインストール:
 bash-completion                               noarch                       1:2.11-4.el9                            rhel-9-for-x86_64-baseos-rpms                       459 k
 libpkgconf                                    x86_64                       1.7.3-9.el9                             rhel-9-for-x86_64-baseos-rpms                        38 k
 pkgconf                                       x86_64                       1.7.3-9.el9                             rhel-9-for-x86_64-baseos-rpms                        45 k
 pkgconf-m4                                    noarch                       1.7.3-9.el9                             rhel-9-for-x86_64-baseos-rpms                        16 k
 pkgconf-pkg-config                            x86_64                       1.7.3-9.el9                             rhel-9-for-x86_64-baseos-rpms                        12 k
 snap-confine                                  x86_64                       2.58.3-1.el9                            epel                                                2.5 M
 snapd-selinux                                 noarch                       2.58.3-1.el9                            epel                                                192 k

トランザクションの概要
==============================================================================================================================================================================
インストール    8 パッケージ
アップグレード  2 パッケージ

ダウンロードサイズの合計: 25 M
これでよろしいですか? [y/N]: y
パッケージのダウンロード:
(1/10): snapd-selinux-2.58.3-1.el9.noarch.rpm                                                                                                 1.1 MB/s | 192 kB     00:00    
(2/10): snap-confine-2.58.3-1.el9.x86_64.rpm                                                                                                  7.9 MB/s | 2.5 MB     00:00    
(3/10): pkgconf-1.7.3-9.el9.x86_64.rpm                                                                                                        148 kB/s |  45 kB     00:00    
(4/10): bash-completion-2.11-4.el9.noarch.rpm                                                                                                 2.1 MB/s | 459 kB     00:00    
(5/10): pkgconf-m4-1.7.3-9.el9.noarch.rpm                                                                                                      41 kB/s |  16 kB     00:00    
(6/10): snapd-2.58.3-1.el9.x86_64.rpm                                                                                                          15 MB/s |  15 MB     00:00    
(7/10): pkgconf-pkg-config-1.7.3-9.el9.x86_64.rpm                                                                                              46 kB/s |  12 kB     00:00    
(8/10): libpkgconf-1.7.3-9.el9.x86_64.rpm                                                                                                     141 kB/s |  38 kB     00:00    
(9/10): selinux-policy-34.1.43-1.el9_1.2.noarch.rpm                                                                                           289 kB/s |  55 kB     00:00    
(10/10): selinux-policy-targeted-34.1.43-1.el9_1.2.noarch.rpm                                                                                  11 MB/s | 6.7 MB     00:00    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
合計                                                                                                                                           11 MB/s |  25 MB     00:02     
Extra Packages for Enterprise Linux 9 - x86_64                                                                                                1.6 MB/s | 1.6 kB     00:00    
GPG 鍵 0x3228467C をインポート中:
 Userid     : &quot;Fedora (epel9) &lt;epel@fedoraproject.org&gt;&quot;
 Fingerprint: FF8A D134 4597 106E CE81 3B91 8A38 72BF 3228 467C
 From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-9
これでよろしいですか? [y/N]: y
鍵のインポートに成功しました
トランザクションの確認を実行中
トランザクションの確認に成功しました。
トランザクションのテストを実行中
トランザクションのテストに成功しました。
トランザクションを実行中
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                     1/1 
  準備             :                                                                                                                                                      1/1 
  アップグレード中 : selinux-policy-34.1.43-1.el9_1.2.noarch                                                                                                             1/12 
  scriptletの実行中: selinux-policy-34.1.43-1.el9_1.2.noarch                                                                                                             1/12 
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                    2/12 
  アップグレード中 : selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                    2/12 
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                    2/12 
  scriptletの実行中: snapd-selinux-2.58.3-1.el9.noarch                                                                                                                   3/12 
  インストール中   : snapd-selinux-2.58.3-1.el9.noarch                                                                                                                   3/12 
  scriptletの実行中: snapd-selinux-2.58.3-1.el9.noarch                                                                                                                   3/12 
  インストール中   : libpkgconf-1.7.3-9.el9.x86_64                                                                                                                       4/12 
  インストール中   : pkgconf-1.7.3-9.el9.x86_64                                                                                                                          5/12 
  インストール中   : pkgconf-m4-1.7.3-9.el9.noarch                                                                                                                       6/12 
  インストール中   : pkgconf-pkg-config-1.7.3-9.el9.x86_64                                                                                                               7/12 
  インストール中   : bash-completion-1:2.11-4.el9.noarch                                                                                                                 8/12 
  インストール中   : snap-confine-2.58.3-1.el9.x86_64                                                                                                                    9/12 
  インストール中   : snapd-2.58.3-1.el9.x86_64                                                                                                                          10/12 
  scriptletの実行中: snapd-2.58.3-1.el9.x86_64                                                                                                                          10/12 
  整理             : selinux-policy-34.1.43-1.el9.noarch                                                                                                                11/12 
  scriptletの実行中: selinux-policy-34.1.43-1.el9.noarch                                                                                                                11/12 
  整理             : selinux-policy-targeted-34.1.43-1.el9.noarch                                                                                                       12/12 
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9.noarch                                                                                                       12/12 
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                   12/12 
  scriptletの実行中: snapd-selinux-2.58.3-1.el9.noarch                                                                                                                  12/12 
  scriptletの実行中: selinux-policy-targeted-34.1.43-1.el9.noarch                                                                                                       12/12 
  検証             : snap-confine-2.58.3-1.el9.x86_64                                                                                                                    1/12 
  検証             : snapd-2.58.3-1.el9.x86_64                                                                                                                           2/12 
  検証             : snapd-selinux-2.58.3-1.el9.noarch                                                                                                                   3/12 
  検証             : pkgconf-1.7.3-9.el9.x86_64                                                                                                                          4/12 
  検証             : pkgconf-m4-1.7.3-9.el9.noarch                                                                                                                       5/12 
  検証             : bash-completion-1:2.11-4.el9.noarch                                                                                                                 6/12 
  検証             : libpkgconf-1.7.3-9.el9.x86_64                                                                                                                       7/12 
  検証             : pkgconf-pkg-config-1.7.3-9.el9.x86_64                                                                                                               8/12 
  検証             : selinux-policy-34.1.43-1.el9_1.2.noarch                                                                                                             9/12 
  検証             : selinux-policy-34.1.43-1.el9.noarch                                                                                                                10/12 
  検証             : selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                                                                                   11/12 
  検証             : selinux-policy-targeted-34.1.43-1.el9.noarch                                                                                                       12/12 
インストール済みの製品が更新されています。

アップグレード済み:
  selinux-policy-34.1.43-1.el9_1.2.noarch                                           selinux-policy-targeted-34.1.43-1.el9_1.2.noarch                                          
インストール済み:
  bash-completion-1:2.11-4.el9.noarch  libpkgconf-1.7.3-9.el9.x86_64  pkgconf-1.7.3-9.el9.x86_64         pkgconf-m4-1.7.3-9.el9.noarch  pkgconf-pkg-config-1.7.3-9.el9.x86_64 
  snap-confine-2.58.3-1.el9.x86_64     snapd-2.58.3-1.el9.x86_64      snapd-selinux-2.58.3-1.el9.noarch 

完了しました!</code></pre><h1 id="479061b0-b248-4782-9f69-2cabcee3e9a1" class="">4.Snapの起動とCertbotのインストール</h1><hr id="1289da9f-3730-8014-ac43-ff49e240ad2e"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4d3bbc3f-4823-45f5-8a51-ba621b59ece1" class="code"><code class="language-Bash"># ln -s /var/lib/snapd/snap /snap
# echo &#x27;export PATH=$PATH:/var/lib/snapd/snap/bin&#x27; &gt; /etc/profile.d/snap.sh
# systemctl enable --now snapd snapd.socket
Created symlink /etc/systemd/system/multi-user.target.wants/snapd.service → /usr/lib/systemd/system/snapd.service.
Created symlink /etc/systemd/system/sockets.target.wants/snapd.socket → /usr/lib/systemd/system/snapd.socket.

# snap install certbot --classic
Setup snap &quot;snapd&quot; (18933) security profiles                                                                                                                                 -
2023-04-26T20:36:34+09:00 INFO Waiting for automatic snapd restart...
certbot 2.5.0 from Certbot Project (certbot-eff✓) installed

# ln -s /snap/bin/certbot /usr/bin/certbot</code></pre><h1 id="95dd33d7-32f6-4036-918d-532387e5788b" class="">5.Let’s EncryptからSSL証明書の取得とssl.confへ反映</h1><hr id="1289da9f-3730-801b-982f-ca028acad660"/><p id="dbe6bb4d-5c81-4206-9d43-344cab431a50" class="">前提に記載した通り理由があって80ポート、443ポートで解放していないサイトもあるので、</p><p id="ce12c5ef-9eee-4525-bb3c-105f639358ea" class="">TXTレコードを利用した方法で実施します。</p><p id="7ca1e594-f59e-47e6-82f6-a996b02ecd46" class="">途中でDNS TXTレコードが表示されるので登録後に、少し経過してからEnterをすることで正常に完了します。</p><p id="28de50f4-6f27-464a-ae9f-ef0b7de547cf" class="">※DNSレコード登録してすぐに実行すると失敗する可能性あります。</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7d30b09e-e879-4c1f-b2fb-c08d1af02eba" class="code"><code class="language-Bash">[root@ray-rhel9 ~]# certbot certonly --manual --key-type rsa -d DomainName --preferred-challenges dns 
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Enter email address (used for urgent renewal and security notices)
 (Enter &#x27;c&#x27; to cancel): EmailAddress

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please read the Terms of Service at
https://letsencrypt.org/documents/LE-SA-v1.3-September-21-2022.pdf. You must
agree in order to register with the ACME server. Do you agree?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing, once your first certificate is successfully issued, to
share your email address with the Electronic Frontier Foundation, a founding
partner of the Let&#x27;s Encrypt project and the non-profit organization that
develops Certbot? We&#x27;d like to send you email about our work encrypting the web,
EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y
Account registered.
Requesting a certificate for DomainName

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please deploy a DNS TXT record under the name:

xxxxxxxxxxxxxxxxxxxxxxx #マスキングしています

with the following value:

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx #マスキングしています

Before continuing, verify the TXT record has been deployed. Depending on the DNS
provider, this may take some time, from a few seconds to multiple minutes. You can
check if it has finished deploying with aid of online tools, such as the Google
Admin Toolbox: https://toolbox.googleapps.com/apps/dig/#TXT/xxxxxxxxxxxxxxxxxxxxxxx
Look for one or more bolded line(s) below the line &#x27;;ANSWER&#x27;. It should show the
value(s) you&#x27;ve just added.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Press Enter to Continue

Successfully received certificate.
Certificate is saved at: /etc/letsencrypt/live/DomainName/fullchain.pem
Key is saved at:         /etc/letsencrypt/live/DomainName/privkey.pem
This certificate expires on 2023-07-25.
These files will be updated when the certificate renews.

NEXT STEPS:
- This certificate will not be renewed automatically. Autorenewal of --manual certificates requires the use of an authentication hook script (--manual-auth-hook) but one was not provided. To renew this certificate, repeat this same certbot command before the certificate&#x27;s expiry date.
We were unable to subscribe you the EFF mailing list because your e-mail address appears to be invalid. You can try again later by visiting https://act.eff.org.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
If you like Certbot, please consider supporting our work by:
 * Donating to ISRG / Let&#x27;s Encrypt:   https://letsencrypt.org/donate
 * Donating to EFF:                    https://eff.org/donate-le
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# ls -la /etc/letsencrypt/live/DomainName/
合計 4
drwxr-xr-x 2 root root  93  4月 26 20:45 .
drwx------ 3 root root  46  4月 26 20:45 ..
-rw-r--r-- 1 root root 692  4月 26 20:45 README
lrwxrwxrwx 1 root root  42  4月 26 20:45 cert.pem -&gt; ../../archive/DomainName/cert1.pem
lrwxrwxrwx 1 root root  43  4月 26 20:45 chain.pem -&gt; ../../archive/DomainName/chain1.pem
lrwxrwxrwx 1 root root  47  4月 26 20:45 fullchain.pem -&gt; ../../archive/DomainName/fullchain1.pem
lrwxrwxrwx 1 root root  45  4月 26 20:45 privkey.pem -&gt; ../../archive/DomainName/privkey1.pem

# cat /etc/httpd/conf.d/ssl.conf | grep test.
SSLCertificateFile /etc/letsencrypt/live/DomainName/cert.pem
SSLCertificateKeyFile /etc/letsencrypt/live/DomainName/privkey.pem
SSLCertificateChainFile /etc/letsencrypt/live/DomainName/chain.pem

[root@ray-rhel9 ray-adm]# systemctl restart httpd</code></pre><p id="f5cf3ee9-6a05-4168-8a0e-1080a7bc3936" class="">DigicertでSSLのCheckを実施します。</p><figure id="12adbc2c-27c2-406c-b030-18673a3c91cf"><a href="https://www.digicert.com/help/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">SSL Certificate Checker - Diagnostic Tool | DigiCert.com</div><div class="bookmark-description">Problem with your SSL certificate installation? Enter the name of your server and our SSL Certificate checker will help you locate the problem.</div></div><div class="bookmark-href"><img src="https://www.digicert.com/content/dam/digicert/images/DigiCertFavicon_32x32.png" class="icon bookmark-icon"/>https://www.digicert.com/help/</div></div></a></figure><figure id="148f5f95-8aff-44b7-a0aa-38c9ca4a9780" class="image" style="text-align:left"><a href="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled.png"><img style="width:384px" src="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled.png"/></a></figure><p id="4a9e14f5-055a-4e20-b93b-178d64043651" class="">SSLで公開したサイトのWebページの強度をQualys SSL Labsで確認します。</p><p id="1951321f-6ac3-4526-bb49-6e14706de271" class="">※設定はApache関連で設定した内容に基づいたもので実施しています。</p><figure id="3cafae2d-1c1c-4e3b-8b82-dfc62a5ffcd4"><a href="https://www.ssllabs.com/ssltest/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">SSL Server Test (Powered by Qualys SSL Labs)</div><div class="bookmark-description">A comprehensive free SSL test for your public web servers.</div></div><div class="bookmark-href"><img src="https://www.ssllabs.com/favicon.ico" class="icon bookmark-icon"/>https://www.ssllabs.com/ssltest/</div></div></a></figure><figure id="615c3b7a-c52d-4d33-b383-abbc6c1a7a93" class="image" style="text-align:left"><a href="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled%201.png"><img style="width:960px" src="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled%201.png"/></a></figure><h1 id="d0f90b14-9af5-4b5c-97d7-dfcf0c6058c9" class="">6.Webサイト評価をA+にするための修正</h1><hr id="1289da9f-3730-808b-ab83-d0af74a013b4"/><p id="976c1e13-2d94-4d86-af09-63f584a2bd25" class="">評価内容をみて①から③を実施しスコアに変化はありませんでしたが、④を実行することでA+の評価に変わりました。</p><figure id="b7df3982-c96e-4ce9-8518-7a8f18fbc1fa" class="image" style="text-align:left"><a href="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled%202.png"><img style="width:960px" src="RHEL9%E6%A4%9C%E8%A8%BC%20%E2%91%A5Let&#x27;s%20Encrypt%E3%81%AB%E3%82%88%E3%82%8BSSL%E8%A8%BC%E6%98%8E%E6%9B%B8%E9%81%A9%E7%94%A8%20e09285f508d14c1e89904c62e5292238/Untitled%202.png"/></a></figure><p id="a44a029b-3483-45cc-8653-64ededba3677" class="">①DNS CAAが赤文字</p><p id="13f71fe4-1927-4dd4-933a-3da137e9f969" class="">DNS CAAとはドメインのSSL証明書に署名を許可する認証局を指定するDNSエントリです。</p><p id="bf99d049-ce22-44f9-85e3-3a50d74aeaab" class="">CAAレコードで認証局を指定することによりSSL証明書の改ざんを防ぐことができます。</p><p id="79199007-c755-40b2-b61f-ca52976137c4" class="">CAAレコードは以下で生成できるので、生成したレコードを管理しているDNSにCAAレコードを追加してください。</p><figure id="f55ed9d4-869f-4cba-98a2-236e62133787"><a href="https://sslmate.com/caa/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">CAA Record Generator</div></div><div class="bookmark-href"><img src="https://sslmate.com/assets/img/favicon.png" class="icon bookmark-icon"/>https://sslmate.com/caa/</div></div></a></figure><p id="a1428dd6-d6bd-4378-868b-c291d19f8031" class="">②Cipher SuitesでいくつかWEAKが発生</p><p id="15f6b508-3773-47e2-8126-4dfdbbd4419c" class="">httpd.confのSSLCipherSuiteにて、WEAKとなっているものを除きます。</p><p id="a9d1b7aa-51eb-46ae-bca9-8a31561bb196" class="">※Handshake Simulationを確認し、必要と思われるものは閲覧できるようにして下さい。</p><p id="571b4c6f-5e6e-489b-8c3d-4bf9dc29b50c" class="">※よくわからない人はIPAが推奨を定義しているので参考にすると良いかも</p><figure id="f984039f-a039-4407-84cb-684df1e2a90e"><a href="https://www.ipa.go.jp/security/crypto/guideline/gmcbt80000005ufv-att/tls_cipher_suite_config_20200707.pdf" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title"></div></div><div class="bookmark-href">https://www.ipa.go.jp/security/crypto/guideline/gmcbt80000005ufv-att/tls_cipher_suite_config_20200707.pdf</div></div></a></figure><p id="b28bccd7-9f1b-4642-9ea3-8e6a1717aa15" class="">③TLS証明書のRSA鍵を4096bitへ変更</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b4355a6c-e2ca-4ce1-b8d4-26816dbb0b97" class="code"><code class="language-Bash"># certbot certonly --manual --key-type rsa --rsa-key-size 4096 -d DomainName --preferred-challenges dns</code></pre><p id="af5504c1-c866-4e32-a7fe-8f2d7e721461" class="">④HSTSの設定</p><p id="4519b035-6638-4c69-a931-6e56d9ea4df1" class="">Webブラウザに対して常にHTTPSによる通信を行うよう指示</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="98a2c3bb-d6eb-42ea-9890-e6c72cc5bd8b" class="code"><code class="language-Bash">Header always set Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot;</code></pre><p id="16d67877-d63f-4036-a6ba-0ea5e8fa135b" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>