# Proxmoxの管理画面をhttps化

![unnamed.png](Proxmox%E3%81%A6%E3%82%99VM%E4%BD%9C%E6%88%90%E5%BE%8C%E3%81%AEAgent%E5%B0%8E%E5%85%A5%2007556cbc1877471eb16cfa7aa913b428/unnamed.png)

◼️目次

# はじめに

---

ProxmoxのUIをhttps化しないと毎度保護されていない通信となり処理が面倒なので、

ちゃんと証明書を導入したいと思います。DNSはCloudflareで管理していますのでCloudflareを使ったやり方になります。

# CloudflareでAPITOKENの発行

---

Cloudflareの画面にログインしてマイプロフィールからAPIトークンをクリックします。

DNSゾーンが読み書きできれば問題なので、ゾーンDNSを編集するのテンプレートを使用するをクリックします。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled.png)

トークンを作成する画面が表示されますので、トークンを作成します。

真ん中の特定のゾーン欄から特定のドメインを指定して、概要に進みます。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%201.png)

内容を確認してトークンを作成するをクリックします。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%202.png)

トークンが発行されるのでトークンを控えておきます。

![Untitled.png](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%203.png)

# Proxmoxでプラグイン登録

---

Proxmoxにログインをして、ACMEをクリックします。

Challengeプラグインからacme-cloudflareを選択します。TokenとZoneIDに情報を登録します。

ZoneIDはCLoudflareログイン後のTOPページに記載があります。

![Untitled.png](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%204.png)

アカウント欄でアカウト名とEmailアドレスを入力し、ACMEディレクトリをLet`s Encrypt V2にして登録に進みます。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%205.png)

TASK OKとなればOKです。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%206.png)

# Proxmoxで証明書発行

---

Proxomoxのサーバから証明書をクリックして、ドメインの追加をするために追加をクリックします。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%207.png)

ChallengeタイプをDNS、プラグインをacme-cloudflare、登録するドメインを入力します。

![Untitled.png](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%208.png)

TASK OKとなればOKです。

![Untitled](Proxmox%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%82%92https%E5%8C%96%201795969a62bd496c966640e1bf7d362f/Untitled%209.png)

最後に参照先としている自宅DNSサーバにDNSレコードを追加することでProxmoxのhttpsでアクセスすることで、

Let`s Encryptの証明書が適用されていればOKです。

自宅DNSサーバがない人はアクセスするPCのhostsファイルを書き換えてあげるでもよいかと思います。